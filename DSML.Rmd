```{r}
library("tidyverse")
reservations = read_csv("Hotel Reservations.csv") 
reservations = reservations %>% mutate(stringdate = paste(as.character(arrival_date),as.character(arrival_month), sep = ",")) %>% mutate(stringdate2 = paste(stringdate, as.character(arrival_year), sep = ",")) %>% mutate(dateobject=as.Date(stringdate2, format = "%d,%m,%Y")) %>% select(-c(stringdate, stringdate2))
reservations = reservations %>% mutate(numerated = ifelse(booking_status == "Canceled", 1, 0)) %>% mutate(previous_booking_fixed = ifelse(repeated_guest == 0, 0.5, (no_of_previous_bookings_not_canceled)/(no_of_previous_cancellations + no_of_previous_bookings_not_canceled)))
reservations = reservations %>% mutate(booking_status = ifelse(booking_status == "Canceled", 0, 1))
reservations
reservations %>% select(market_segment_type) %>% unique()
reservations %>% select(room_type_reserved) %>% unique()
reservations %>% select(type_of_meal_plan) %>% unique()

table(reservations$market_segment_type)
table(reservations$room_type_reserved)
table(reservations$type_of_meal_plan)
###Numerate market_segement_type, room_type_reserved, type_of_meal_plan
```

```{r}
library("tidyverse")
library(corrplot)
correlation = cor(reservations %>% select(no_of_adults, no_of_children, no_of_weekend_nights, no_of_week_nights, required_car_parking_space, lead_time, repeated_guest, no_of_previous_cancellations, no_of_previous_bookings_not_canceled, avg_price_per_room, no_of_special_requests, previous_booking_fixed, booking_status))
corrplot(correlation, tl.srt = 40)
```


```{r}
meal_relation = glm(booking_status ~ factor(type_of_meal_plan), family = binomial, data = reservations)
summary(meal_relation)
```

It looks like only certain meal plans may dictate whether a customer cancels their booking or not.
We can see that the Meal Plan 2 is the meal that can determine whether a customer cancels their booking or not.
Hence, I think that we should combine meal plan 1, 3, and not specified together and set make an entirely new category out of meal plan 2. The most effective remedy would be to make this column binary

```{r}
reservations= reservations %>% mutate(mealplan_numerated  = ifelse("Meal Plan 2", 0, 1))
```


```{r}
room_relation = glm(booking_status ~ factor(room_type_reserved), family = binomial, data = reservations)
summary(room_relation)
```
Room type 1, 2, and 3 are statistically the same when it comes to determining booking status. Room_Type_4 to Room_Type 7's effect are significant, which means that we should likely convert these categorical variables to scores. 

Room type 6 has the lowest effect, so it should have a score of 0. Hence, room 4 should have a score of 1; rooms 1, 2,3 should have scores of 2; room 5 should have a score of 3; and room 7 should have a score of 4. 

```{r}

reservations = reservations %>% mutate(roomtype_numerated = ifelse(room_type_reserved %in% c("Room_Type 6"), 0,
ifelse(room_type_reserved %in% c("Room_Type 4"), 1,                                                                    ifelse(room_type_reserved %in% c("Room_Type 1", "Room_Type 2", "Room_Type 3"), 2,                                     ifelse(room_type_reserved %in% c("Room_Type 5"), 3,                                                                    ifelse(room_type_reserved %in% c("Room_Type 7"), 7, NA))))))
```

```{r}
room_relation.score = glm(booking_status ~ roomtype_numerated, family = binomial, data = reservations)
summary(room_relation.score)
```


